{% extends 'core/base.html' %}
{% load static %}
{% block content %}

<div class="container mt-5">

  <!-- HEADER PREMIUM -->
  <div class="page-header mb-5" style="background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);">
    <div>
      <h2 class="fw-bold mb-1" style="color: #f8f9fa; font-size: 2.5rem;">
        <i class="fas fa-coins text-warning me-2"></i> Tableau de Bord des Gains
      </h2>
      <p class="text-muted mb-0" style="color: #f8f9fa !important;">
        Suivez vos commissions et retraits en temps r√©el
      </p>
    </div>

    <button onclick="goBack()" class="btn btn-light shadow-sm">
      <i class="fas fa-arrow-left me-1"></i> Retour
    </button>
  </div>

  <!-- CARTES GAINS -->
  <div class="row g-4" >
    <div class="col-md-3">
      <div class="gain-card gain-success">
        <h6>Gains personnels</h6>
        <h3>{{ gain_propre|floatformat:2 }} FC</h3>
      </div>
    </div>

    <div class="col-md-3">
      <div class="gain-card gain-primary">
        <h6>1√®re g√©n√©ration (10%)</h6>
        <h3>{{ gain_1|floatformat:2 }} FC</h3>
      </div>
    </div>

    <div class="col-md-3">
      <div class="gain-card gain-info">
        <h6>2√®me g√©n√©ration (6%)</h6>
        <h3>{{ gain_2|floatformat:2 }} FC</h3>
      </div>
    </div>

    <div class="col-md-3">
      <div class="gain-card gain-dark">
        <h6>3√®me g√©n√©ration (3%)</h6>
        <h3>{{ gain_3|floatformat:2 }} FC</h3>
      </div>
    </div>
  </div>

  <!-- TOTAL -->
  <div class="total-card mt-4" style="background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);">
    <h4 style="color: #f8f9fa;">Total des gains</h4>
    <h2 class="text-success fw-bold">
      {{ total_gains|floatformat:2 }} FC
    </h2>
  </div>

  <!-- HISTORIQUE -->
  <div class="card mt-4 shadow-sm border-0 rounded-4" style="background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);">
    <div class="card-body">
      <h5 class="mb-3" style="color: #f8f9fa; font-size: 1.5rem;">üìú Historique des transactions</h5>

      <div class="table-responsive">
        <table class="table table-hover align-middle">
          <thead class="table-light">
            <tr>
              <th>Date</th>
              <th>Type</th>
              <th>Montant</th>
            </tr>
          </thead>
          <tbody>
            {% for gain in historique %}
            <tr>
              <td class="text-nowrap">{{ gain.date }}</td>
              <td>{{ gain.type }}</td>
              <td class="text-success fw-semibold">+ {{ gain.montant }} FC</td>
            </tr>
            {% empty %}
            <tr>
              <td colspan="3" class="text-center text-muted">
                Aucun gain enregistr√©
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

    </div>
  </div>

  <!-- BOUTON RETRAIT -->
  <div class="text-end mt-4">
    <a href="{% url 'demander_retrait' %}" class="btn btn-warning px-4 shadow-sm">
      üí≥ Demander un retrait
    </a>
  </div>

</div>

<!-- CHART.JS -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
function goBack() {
    if (document.referrer) {
        window.history.back();
    } else {
        window.location.href = "{% url 'home' %}";
    }
}
</script>

<style>
.page-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: linear-gradient(135deg, #ffffff, #f8f9fa);
    padding: 20px 25px;
    border-radius: 15px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.05);
}

.gain-card {
    padding: 25px;
    border-radius: 15px;
    color: white;
    transition: 0.3s ease;
    box-shadow: 0 8px 20px rgba(0,0,0,0.08);
}

.gain-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 25px rgba(0,0,0,0.12);
}

.gain-card h6 {
    opacity: 0.9;
}

.gain-card h3 {
    font-weight: 700;
}

.gain-success { background: linear-gradient(135deg, #28a745, #218838); }
.gain-primary { background: linear-gradient(135deg, #007bff, #0056b3); }
.gain-info { background: linear-gradient(135deg, #17a2b8, #117a8b); }
.gain-dark { background: linear-gradient(135deg, #343a40, #1d2124); }

.total-card {
    background: white;
    padding: 25px;
    border-radius: 15px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.05);
    text-align: center;
}
</style>

{% endblock %}
